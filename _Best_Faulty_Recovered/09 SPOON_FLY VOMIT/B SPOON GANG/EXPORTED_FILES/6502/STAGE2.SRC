; ************************************; **................................**; **.TIMS.MUSIC.PROGRAM.IN.Z80.6502.**; **................................**; **.....WRITTEN.IN.MAD.Z80..BY.....**; **................................**; **...........TIM.FOLLIN...........**; **................................**; **.REWRITTEN.IN.SENSIBLE.6502..BY.**; **................................**; **.........STEPHEN..RUDDY.........**; **................................**; **..OOOOOOOOO.OOOOOOOO.OOOOOOOO...**; **..OOO.O.OOO.OOO..OOO.OOO...OOO..**; **..OOO.O.OOO.OOOOOOOO.OOO...OOO..**; **..OOO.O.OOO.OOO..OOO.OOO...OOO..**; **..OOO.O.OOO.OOO..OOO.OOOOOOOO...**; **................................**; **...<MUSICIANS AND DECKHANDS>....**; **................................**; **.PROJECT.].<HELLO TIMS MUM!!!!>.**; **.DATE....].<15/11/1987>.........**; **................................**; ************************************æ$2000∫$A000;=====================================;ZERO PAGE USAGEZP:®2PC_A:®ZPPC_B:®ZP+2PC_C:®ZP+4;FROM HERE DOWN THESE DON'T NEED TO BE;ZERO PAGE SO CAN BE MOVED TO A VAR;AREA.COUNA:®ZP+6COUNB:®ZP+7COUNC:®ZP+8GATEA:®ZP+9GATEB:®ZP+10GATEC:®ZP+11AGAT:®ZP+12BGAT:®ZP+13CGAT:®ZP+14REPA:®ZP+15REPB:®ZP+16REPC:®ZP+17RESA:®ZP+18RESB:®ZP+20RESC:®ZP+22FLAGA:®ZP+24FLAGB:®ZP+25FLAGC:®ZP+26RATEA:®ZP+27RATEB:®ZP+28RATEC:®ZP+29PWMA:®ZP+30PWMB:®ZP+32PWMC:®ZP+34FLRA:®ZP+36FLRB:®ZP+38FLRC:®ZP+40GATERESA:®ZP+42GATERESB:®ZP+43GATERESC:®ZP+44FREQA:®ZP+45FREQB:®ZP+46FREQC:®ZP+47CUTOFF:®ZP+49INITCUT:®ZP+51FILTRATE:®ZP+53FILTCHAN:®ZP+54GOSA:®ZP+56GOSB:®ZP+58GOSC:®ZP+60TRANA:®ZP+62TRANB:®ZP+63TRANC:®ZP+64STOPA:®ZP+65STOPB:®ZP+66STOPC:®ZP+67TUNE_NO:®ZP+68TUNE_STAT:®ZP+69AV_DEL:®ZP+70AV_DEL1:®ZP+71AV_DIR:®ZP+72AV_OFF:®ZP+73AV_RATE:®ZP+74BV_DEL:®ZP+75BV_DEL1:®ZP+76BV_DIR:®ZP+77BV_OFF:®ZP+78BV_RATE:®ZP+79CV_DEL:®ZP+80CV_DEL1:®ZP+81CV_DIR:®ZP+82CV_OFF:®ZP+83CV_RATE:®ZP+84AEF_TIME:®ZP+85AEF_WAIT:®ZP+86AEF_GATE:®ZP+87BEF_TIME:®ZP+88BEF_WAIT:®ZP+89BEF_GATE:®ZP+90CEF_TIME:®ZP+91CEF_WAIT:®ZP+92CEF_GATE:®ZP+93ENDITA:®ZP+94ENDITB:®ZP+95ENDITC:®ZP+96;CACKY ZPTEMP:®ZP+200TEMP1:®ZP+201TEMP2:®ZP+202TEMP3:®ZP+203MAX:®ZP+204TCOL:®ZP+208OLDFS:®ZP+210MINS:®ZP+216SECS:®ZP+217TIM:®ZP+218OLDTS:®ZP+219;=====================================;SYSTEM EQUATES PLUS OTHER CACKVIC:®$D000SID:®$D400BDRCOL:®VIC+$20SCRCOL:®VIC+$21;=====================================;TEST PROGRAMTESTIT:Õ∂#0»BDRCOL»SCRCOL∑#2LOOP0:»0,XØçLOOP0ü”∂#$17»$D018∑#0LOOP:∂#1»$D800,X»$D900,X»$DA00,X»$DB00,X∂#32»$0400,X»$0500,X»$0600,X»$0700,XØçLOOP∑#<STARTMES∏#>STARTMES≥MESS∂#<BOTÀ«#<TOP»MAX∂#>BOT«#>TOP»MAX+1∑#15∏#1∂#MAX≥HEXIT∂#<BOTDATAÀ«#<TOPDATA»MAX∂#>BOTDATA«#>TOPDATA»MAX+1∑#15∏#2∂#MAX≥HEXIT∑#0≥TUNE∂#0»MAX+1»MAX+2»MAX+3∂#50»TIMLOOP1:≥WAITRAST≥DISPLAY≥TESTKEYS¥LOOP1TESTKEYS:∑#$DF∏#$FE≥KEYSêSPEEDUPTK0:∏#$F7≥KEYSèTK2TK1:∂$D012ò#160çTK1éTK0TK2:√SPEEDUP:∑#50SU1:üçSU1Æ$D020≥CHAN1û$D020≥CLOCK¥TESTKEYSKEYS:…$DC00ö$DC01óçKEYS1ÀKEYS1:∂#$7F»$DC00∂#$FF»$DC01√DISPLAY:∑#7∏#4∂#CUTOFF≥HEXIT∑#7∏#22∂ENDITA≥HEXDIGIT∑#13∏#22∂ENDITB≥HEXDIGIT∑#19∏#22∂ENDITC≥HEXDIGIT∑#7∏#19∂AEF_TIME≥HEXDIGIT∑#13∏#19∂BEF_TIME≥HEXDIGIT∑#19∏#19∂CEF_TIME≥HEXDIGIT∑#7∏#20∂AEF_GATE≥HEXDIGIT∑#13∏#20∂BEF_GATE≥HEXDIGIT∑#19∏#20∂CEF_GATE≥HEXDIGIT∑#7∏#16∂AV_RATE≥HEXDIGIT∑#13∏#16∂BV_RATE≥HEXDIGIT∑#19∏#16∂CV_RATE≥HEXDIGIT∑#7∏#17∂AV_LIM+1≥HEXDIGIT∑#13∏#17∂BV_LIM+1≥HEXDIGIT∑#19∏#17∂CV_LIM+1≥HEXDIGIT∑#7∏#14∂AGAT≥HEXDIGIT∑#13∏#14∂BGAT≥HEXDIGIT∑#19∏#14∂CGAT≥HEXDIGIT∑#7∏#13∂OLDTS≥HEXDIGIT∑#13∏#13∂OLDTS+1≥HEXDIGIT∑#19∏#13∂OLDTS+2≥HEXDIGIT∑#17∏#4∂FILTRATE≥HEXDIGIT∑#25∏#4∂FILTCHAN≥HEXDIGIT∑#7∏#9∂RATEA≥HEXDIGIT∑#13∏#9∂RATEB≥HEXDIGIT∑#19∏#9∂RATEC≥HEXDIGIT∑#7∏#12∂COUNA≥HEXDIGIT∑#13∏#12∂COUNB≥HEXDIGIT∑#19∏#12∂COUNC≥HEXDIGIT∑#15∏#0∂#MAX≥HEXIT∑#7∏#8∂#PWMA≥HEXIT∑#13∏#8∂#PWMB≥HEXIT∑#19∏#8∂#PWMC≥HEXIT∑#36∏#0∂#MAX+2≥HEXIT∑#7∏#10∂#OLDFS≥HEXIT∑#13∏#10∂#OLDFS+2≥HEXIT∑#19∏#10∂#OLDFS+4≥HEXIT∑#7∏#7∂FREQA≥DI1∑#13∏#7∂FREQB≥DI1∑#19∏#7∂FREQCDI1:…TEMPã#4–‘åA—∂MUL40,YóäTEMP»TEMP∂MUL40+1,Yä#4»TEMP1∏#0DI2:∂N,X»(TEMP),YØ∞ö#4çDI2√WAITRAST:∂$D012ò#160çWAITRAST∂#2»$D020≥CHAN1∂$D012À«#160»MAXòMAX+2èWR1»MAX+2WR1:∂#0»$D020CLOCK:ûTIMçWR2∂#50»TIMÃ∂SECSóä#1»SECSò#$60çCL1∂#0»SECS∂MINSä#0»MINSCL1:õWR2:∑#29∏#2∂MINS≥HEXDIGIT∑#32∏#2∂SECS¥HEXDIGIT;HEX PRINTING ROUTINE;ENTER X=xpos,Y=ypos,A=ZP addressHEXIT:…TEMP–‘åA—∂MUL40,YóäTEMP»TEMP∂MUL40+1,Yä#4»TEMP1∂1,XπAπAπAπA—∂TAB,Y∏#0»(TEMP),Y∂1,Xã#15—∂TAB,Y∏#1»(TEMP),Y∂0,XπAπAπAπA—∂TAB,Y∏#2»(TEMP),Y∂0,Xã#15—∂TAB,Y∏#3»(TEMP),Y√HEXDIGIT:…TEMP–‘åA—∂MUL40,YóäTEMP»TEMP∂MUL40+1,Yä#4»TEMP1“πAπAπAπA—∂TAB,Y∏#0»(TEMP),Y“ã#15—∂TAB,Y∏#1»(TEMP),Y√MESS:…TEMP TEMP1∏#0MESS1:∂(TEMP),Yò#16çMESS1A√MESS1A:êMESS2»TCOL∞çMESS1MESS2:ò#31çMESS3∞∂(TEMP),Y»TEMP2∞∂(TEMP),YåA–∂MUL40,XóäTEMP2»TEMP2∂MUL40+1,Xä#4»TEMP3∞çMESS1MESS3: MESS4+1∏#0»(TEMP2),Y∂TEMP3©#$DC»TEMP3∂TCOL»(TEMP2),Y∂TEMP3©#$DC»TEMP3ÆTEMP2çMESS4ÆTEMP3MESS4:∏#0∞çMESS1STARTMES:°31,0,0,14°"RASTER TIME : $0000"°"     "°"MAX TIME : $0000"°31,0,1,10°"PROG LENGTH : $0000"°31,0,2°"DATA LENGTH : $0000"°31,24,2,8°"TIME 00:00"°31,0,4,5°"CUTOFF"°31,12,4°"RATE"°31,20,4°"CHAN"°31,7,6,3°"CH#0  "°"CH#1  "°"CH#2"°31,0,8,5°"PWM"°31,0,9°"RATES"°31,0,10°"FREQS"°31,0,12°"COUNTS"°31,0,13°"LENGTH"°31,0,14°"GATES"°31,0,16°"VRATES"°31,0,17°"VLIMIT"°31,0,19°"EDELAY"°31,0,20°"EGATE"°31,0,22°"ENDS"°16N:DB "NOTE"°"FREQ"MUL40:¢0,40,80,120,160¢200,240,280,320,360¢400,440,480,520,560¢600,640,680,720,760¢800,840,880,920,960TAB:°"0123456789ABCDEF";=====================================TOP:TUNE:…TUNE_NO∂ATABS_LO,X»PC_A∂ATABS_HI,X»PC_A+1∂BTABS_LO,X»PC_B∂BTABS_HI,X»PC_B+1∂CTABS_LO,X»PC_C∂CTABS_HI,X»PC_C+1∑#1…COUNA…COUNB…COUNCü…GATEA…GATEB…GATEC…FREQA…FREQB…FREQC…MUSIC+1…TRANA…TRANB…TRANC…AEF_TIME…BEF_TIME…CEF_TIME…AEF_WAIT…BEF_WAIT…CEF_WAIT…AV_DEL…BV_DEL…CV_DELü…STOPA…STOPB…STOPC…ENDITA…ENDITB…ENDITC…TUNE_STAT∂#8»SID+4»SID+11»SID+18∂#3»PWMA+1»PWMB+1»PWMC+1∑#28CLEAR:∂#8»SID,X∂#0»SID,XüìCLEAR√ATABS_LO:°<TIM_AATABS_HI:°>TIM_ABTABS_LO:°<TIM_BBTABS_HI:°>TIM_BCTABS_LO:°<TIM_CCTABS_HI:°>TIM_C;=====================================;CHANNEL 1'S ROUTINESCHAN1:∂STOPAíCHAN11¥CHAN2CHAN11:∂AEF_WAITéAVIBONûAEF_WAITçAVIBON∂AV3+1»SID»OLDFS;REMOVE∂AV4+1»SID+1»OLDFS+1;REMOVE∂FLAGAéAVIBON∂AGATΩ#1»SID+4AVIBON:∂AV_DELéAMOD∂AV_DEL1éAVIBON1ûAV_DEL1çAMODAVIBON1:∂AV_OFF∏AV_LIM+1çAV_MOD1∂AV3+1∑AV4+1∏AV_MOD1+1éAV0óäAV_RATEèAV0AØçAV0AAV0:À«AV_RATEêAV0AüAV0A:»AV3+1…AV4+1¥AV7AV_MOD1:∑#0éAV1óäAV_RATEAV_LIM:ò#0èAV2ÆAV_MOD1+1AV1:À«AV_RATEìAV2ûAV_MOD1+1∂AV5+1©#255»AV5+1∂#0AV2:»AV_OFFAV3:∂#0AV4:∑#0AV5:∏#0éAV6óäAV_OFFèAV7ØçAV7AV6:À«AV_OFFêAV7üAV7:»SID…SID+1»OLDFS…OLDFS+1;REMOVEAMOD:∂#0çPRATTAGOA:∂PWMAÀ«RATEA»PWMA∂PWMA+1«#0»PWMA+1íUPITAçCHAN1A∂PWMAò#100êCHAN1AUPITA:ûAMOD+1PRATTA:∂PWMAóäRATEA»PWMA∂PWMA+1ä#0»PWMA+1ò#15éTESTAèCHAN1AêDOWNITATESTA:∂PWMAò#155èCHAN1ADOWNITA:ÆAMOD+1¥GOACHAN1A:∂PWMA»SID+2∂PWMA+1»SID+3ûCOUNA∂ENDITAòCOUNAéCHAN1B∂GATEAçCHAMCHAN1B:∂AGATã#254»SID+4ÆGATEACHAM:ûGATEA∂COUNAéCHAM0A_FART1:¥CHAN2CHAM0:∂FREQAìATOP∏#0CHAMA:∂(PC_A),Y»TEMP∞∂(PC_A),Y»TEMP1∞ΩTEMPçCHAM1ÆFREQAéADDYACHAM1:∂TEMP»SID»OLDFS;REMOVE∂TEMP1¥ATINADDYA:‘óäPC_A»PC_AèATOPÆPC_A+1ATOP:∏#0∂(PC_A),YìATOP1ATESTS:ã#127∞–∂JUMPA_LO,X»ATESTS1+1∂JUMPA_HI,X»ATESTS1+2ATESTS1:¥ATOPATOP1:óäTRANA–∂NOTES_LO,X»SID»AV3+1»OLDFS;REMOVE∂NOTES_HI,X»AV4+1∞ATIN:»SID+1»OLDFS+1;REMOVE∂(PC_A),Y∞»COUNA»OLDTS;REMOVE∂AV_DELéATIN1»AV_DEL1∂AV_DIR»AV_MOD1+1ATIN1:∂GATERESA»GATEA‘óäPC_A»PC_AèAT0ÆPC_A+1AT0:∂FLRAΩFLRA+1éAT0C∂FLRA»PWMA∂FLRA+1»PWMA+1∂#255»AMOD+1AT0C:∂FILTCHANçAT0A∂INITCUTΩINITCUT+1éAT0A∂INITCUT»CUTOFF∂INITCUT+1»CUTOFF+1ATMOD:∂#0»MUSIC+1AT0A:∂FLAGAéAT0B∂AGAT∑AEF_TIMEéAT0AA…AEF_WAIT∂AEF_FREQ»SID»OLDFS;REMOVE∂AEF_FREQ+1»SID+1»OLDFS+1;REMOVE∂AEF_GATEAT0AA:Ω#1»SID+4AT0B:¥CHAN2A_FOR:∂(PC_A),Y∞»REPA∂PC_Aóä#2»RESA»PC_A∂PC_A+1ä#0»RESA+1»PC_A+1¥ATOPA_NEXT:ûREPAéAT1A∂RESA»PC_A∂RESA+1»PC_A+1¥ATOPA_GATE:∂#1»FLAGA∂(PC_A),Y∞»GATERESAAT1A:¥ADDYAA_KILL:∂#0»FLAGA¥ADDYAA_SEND:∂(PC_A),YATT4:–∞∂(PC_A),Y∞»SID,X∂(PC_A),Yò#255çATT4∞¥ADDYAA_SETGATE:∂(PC_A),Y»SID+4»AGAT∞¥ADDYAA_STOP:ÆSTOPA¥CHAN2A_PULSE:∂(PC_A),Y∞»RATEA∂(PC_A),Y∞»FLRA»PWMA∂(PC_A),Y∞»FLRA+1»PWMA+1¥ADDYAA_FREQS:ûFREQA¥CHAMAA_FILTER:∂(PC_A),Y»FILTRATE∞∂(PC_A),Y»ATMOD+1∞∂(PC_A),Y»CUTOFF»INITCUT∞∂(PC_A),Y»CUTOFF+1»INITCUT+1∞¥ADDYAA_CLAIM:∂#0»FILTCHAN¥ADDYAA_GOSUB:∂PC_Aóä#3»GOSA∂PC_A+1ä#0»GOSA+1∂(PC_A),Y–∞∂(PC_A),Y»PC_A+1…PC_A¥ATOPA_RETURN:∂GOSA»PC_A∂GOSA+1»PC_A+1¥ATOPA_TRANS:∂(PC_A),Y»TRANA∞¥ADDYAA_SETVIB:∂(PC_A),Y»AV_DEL∞∂(PC_A),Y»AV_RATE∞∂(PC_A),Y»AV_LIM+1∞∂(PC_A),Y»AV_DIR∞¥ADDYAA_EFFECT:∂(PC_A),Y»AEF_TIME∞∂(PC_A),Y»AEF_GATE∞∂(PC_A),Y»AEF_FREQ∞∂(PC_A),Y»AEF_FREQ+1∞¥ADDYAAEF_FREQ:¢0A_END:∂(PC_A),Y»ENDITA∞¥ADDYAJUMPA_LO:°<A_PULSE;      0°<A_NEXT;       1°<A_FOR;        2°<A_GATE;       3°<A_KILL;       4°<A_SEND;       5°<A_STOP;       6°<A_FREQS;      7°<A_FILTER;     8°<A_CLAIM;      9°<A_GOSUB;     10°<A_RETURN;    11°<A_TRANS;     12°<A_SETGATE;   13°<A_SETVIB;    14°<A_EFFECT;    15°<A_END;       16JUMPA_HI:°>A_PULSE;      0°>A_NEXT;       1°>A_FOR;        2°>A_GATE;       3°>A_KILL;       4°>A_SEND;       5°>A_STOP;       6°>A_FREQS;      7°>A_FILTER;     8°>A_CLAIM;      9°>A_GOSUB;     10°>A_RETURN;    11°>A_TRANS;     12°>A_SETGATE;   13°>A_SETVIB;    14°>A_EFFECT;    15°>A_END;       16;=====================================;CHANNEL 2'S ROUTINESCHAN2:∂STOPBíCHAN22¥CHAN3CHAN22:∂BEF_WAITéBVIBONûBEF_WAITçBVIBON∂BV3+1»SID+7»OLDFS+2;REMOVE∂BV4+1»SID+8»OLDFS+3;REMOVE∂FLAGBéBVIBON∂BGATΩ#1»SID+11BVIBON:∂BV_DELéBMOD∂BV_DEL1éBVIBON1ûBV_DEL1çBMODBVIBON1:∂BV_OFF∏BV_LIM+1çBV_MOD1∂BV3+1∑BV4+1∏BV_MOD1+1éBV0óäBV_RATEèBV0AØçBV0ABV0:À«BV_RATEêBV0AüBV0A:»BV3+1…BV4+1¥BV7BV_MOD1:∑#0éBV1óäBV_RATEBV_LIM:ò#0èBV2ÆBV_MOD1+1BV1:À«BV_RATEìBV2ûBV_MOD1+1∂BV5+1©#255»BV5+1∂#0BV2:»BV_OFFBV3:∂#0BV4:∑#0BV5:∏#0éBV6óäBV_OFFèBV7ØçBV7BV6:À«BV_OFFêBV7üBV7:»SID+7…SID+8»OLDFS+2;REMOVE…OLDFS+3;REMOVEBMOD:∂#0çPRATTBGOB:∂PWMBÀ«RATEB»PWMB∂PWMB+1«#0»PWMB+1íUPITBçCHAN2A∂PWMBò#100êCHAN2AUPITB:ûBMOD+1PRATTB:∂PWMBóäRATEB»PWMB∂PWMB+1ä#0»PWMB+1ò#15éTESTBèCHAN2AêDOWNITBTESTB:∂PWMBò#155èCHAN2ADOWNITB:ÆBMOD+1¥GOBCHAN2A:∂PWMB»SID+9∂PWMB+1»SID+10ûCOUNB∂ENDITBòCOUNBéCHAN2B∂GATEBçCHBMCHAN2B:∂BGATã#254»SID+11ÆGATEBCHBM:ûGATEB∂COUNBéCHBM0B_FART1:¥CHAN3CHBM0:∂FREQBìBTOP∏#0CHBMA:∂(PC_B),Y»TEMP∞∂(PC_B),Y»TEMP1∞ΩTEMPçCHBM1ÆFREQBéADDYBCHBM1:∂TEMP»SID+7»OLDFS+2;REMOVE∂TEMP1¥BTINADDYB:‘óäPC_B»PC_BèBTOPÆPC_B+1BTOP:∏#0∂(PC_B),YìBTOP1BTESTS:ã#127∞–∂JUMPB_LO,X»BTESTS1+1∂JUMPB_HI,X»BTESTS1+2BTESTS1:¥BTOPBTOP1:óäTRANB–∂NOTES_LO,X»SID+7»BV3+1»OLDFS+2;REMOVE∂NOTES_HI,X»BV4+1∞BTIN:»SID+8»OLDFS+3;REMOVE∂(PC_B),Y∞»COUNB»OLDTS+1;REMOVE∂BV_DELéBTIN1»BV_DEL1∂BV_DIR»BV_MOD1+1BTIN1:∂GATERESB»GATEB‘óäPC_B»PC_BèBT0ÆPC_B+1BT0:∂FLRBΩFLRB+1éBT0C∂FLRB»PWMB∂FLRB+1»PWMB+1∂#255»BMOD+1BT0C:∂FILTCHANò#1çBT0A∂INITCUTΩINITCUT+1éBT0A∂INITCUT»CUTOFF∂INITCUT+1»CUTOFF+1BTMOD:∂#0»MUSIC+1BT0A:∂FLAGBéBT0B∂BGAT∑BEF_TIMEéBT0AA…BEF_WAIT∂BEF_FREQ»SID+7»OLDFS+2;REMOVE∂BEF_FREQ+1»SID+8»OLDFS+3;REMOVE∂BEF_GATEBT0AA:Ω#1»SID+11BT0B:¥CHAN3B_FOR:∂(PC_B),Y∞»REPB∂PC_Bóä#2»RESB»PC_B∂PC_B+1ä#0»RESB+1»PC_B+1¥BTOPB_NEXT:ûREPBéBT1A∂RESB»PC_B∂RESB+1»PC_B+1¥BTOPB_GATE:∂#1»FLAGB∂(PC_B),Y∞»GATERESBBT1A:¥ADDYBB_KILL:∂#0»FLAGB¥ADDYBB_SEND:∂(PC_B),YBTT4:–∞∂(PC_B),Y∞»SID,X∂(PC_B),Yò#255çBTT4∞¥ADDYBB_SETGATE:∂(PC_B),Y»SID+11»BGAT∞¥ADDYBB_STOP:ÆSTOPB¥CHAN3B_PULSE:∂(PC_B),Y∞»RATEB∂(PC_B),Y∞»FLRB»PWMB∂(PC_B),Y∞»FLRB+1»PWMB+1¥ADDYBB_FREQS:ûFREQB¥CHBMAB_FILTER:∂(PC_B),Y»FILTRATE∞∂(PC_B),Y»BTMOD+1∞∂(PC_B),Y»CUTOFF»INITCUT∞∂(PC_B),Y»CUTOFF+1»INITCUT+1∞¥ADDYBB_CLAIM:∂#1»FILTCHAN¥ADDYBB_GOSUB:∂PC_Bóä#3»GOSB∂PC_B+1ä#0»GOSB+1∂(PC_B),Y–∞∂(PC_B),Y»PC_B+1…PC_B¥BTOPB_RETURN:∂GOSB»PC_B∂GOSB+1»PC_B+1¥BTOPB_TRANS:∂(PC_B),Y»TRANB∞¥ADDYBB_SETVIB:∂(PC_B),Y»BV_DEL∞∂(PC_B),Y»BV_RATE∞∂(PC_B),Y»BV_LIM+1∞∂(PC_B),Y»BV_DIR∞¥ADDYBB_EFFECT:∂(PC_B),Y»BEF_TIME∞∂(PC_B),Y»BEF_GATE∞∂(PC_B),Y»BEF_FREQ∞∂(PC_B),Y»BEF_FREQ+1∞¥ADDYBBEF_FREQ:¢0B_END:∂(PC_B),Y»ENDITB∞¥ADDYBJUMPB_LO:°<B_PULSE°<B_NEXT°<B_FOR°<B_GATE°<B_KILL°<B_SEND°<B_STOP°<B_FREQS°<B_FILTER°<B_CLAIM°<B_GOSUB°<B_RETURN°<B_TRANS°<B_SETGATE°<B_SETVIB°<B_EFFECT°<B_ENDJUMPB_HI:°>B_PULSE°>B_NEXT°>B_FOR°>B_GATE°>B_KILL°>B_SEND°>B_STOP°>B_FREQS°>B_FILTER°>B_CLAIM°>B_GOSUB°>B_RETURN°>B_TRANS°>B_SETGATE°>B_SETVIB°>B_EFFECT°>B_END;=====================================;CHANNEL 3'S ROUTINESCHAN3:∂STOPCíCHAN33¥MUSICCHAN33:∂CEF_WAITéCVIBONûCEF_WAITçCVIBON∂CV3+1»SID+14»OLDFS+4;REMOVE∂CV4+1»SID+15»OLDFS+5;REMOVE∂FLAGCéCVIBON∂CGATΩ#1»SID+18CVIBON:∂CV_DELéCMOD∂CV_DEL1éCVIBON1ûCV_DEL1çCMODCVIBON1:∂CV_OFF∏CV_LIM+1çCV_MOD1∂CV3+1∑CV4+1∏CV_MOD1+1éCV0óäCV_RATEèCV0AØçCV0ACV0:À«CV_RATEêCV0AüCV0A:»CV3+1…CV4+1¥CV7CV_MOD1:∑#0éCV1óäCV_RATECV_LIM:ò#0èCV2ÆCV_MOD1+1CV1:À«CV_RATEìCV2ûCV_MOD1+1∂CV5+1©#255»CV5+1∂#0CV2:»CV_OFFCV3:∂#0CV4:∑#0CV5:∏#0éCV6óäCV_OFFèCV7ØçCV7CV6:À«CV_OFFêCV7üCV7:»SID+14…SID+15»OLDFS+4;REMOVE…OLDFS+5;REMOVECMOD:∂#0çPRATTCGOC:∂PWMCÀ«RATEC»PWMC∂PWMC+1«#0»PWMC+1íUPITCçCHAN3A∂PWMCò#100êCHAN3AUPITC:ûCMOD+1PRATTC:∂PWMCóäRATEC»PWMC∂PWMC+1ä#0»PWMC+1ò#15éTESTCèCHAN3AêDOWNITCTESTC:∂PWMCò#155èCHAN3ADOWNITC:ÆCMOD+1¥GOCCHAN3A:∂PWMC»SID+16∂PWMC+1»SID+17ûCOUNC∂ENDITCòCOUNCéCHAN3B∂GATECçCHCMCHAN3B:∂CGATã#254»SID+18ÆGATECCHCM:ûGATEC∂COUNCéCHCM0C_FART1:¥MUSICCHCM0:∂FREQCìCTOP∏#0CHCMA:∂(PC_C),Y»TEMP∞∂(PC_C),Y»TEMP1∞ΩTEMPçCHCM1ÆFREQCéADDYCCHCM1:∂TEMP»SID+14»OLDFS+4;REMOVE∂TEMP1¥CTINADDYC:‘óäPC_C»PC_CèCTOPÆPC_C+1CTOP:∏#0∂(PC_C),YìCTOP1CTESTS:ã#127∞–∂JUMPC_LO,X»CTESTS1+1∂JUMPC_HI,X»CTESTS1+2CTESTS1:¥CTOPCTOP1:óäTRANC–∂NOTES_LO,X»SID+14»CV3+1»OLDFS+4;REMOVE∂NOTES_HI,X»CV4+1∞CTIN:»SID+15»OLDFS+5;REMOVE∂(PC_C),Y∞»COUNC»OLDTS+2;REMOVE∂CV_DELéCTIN1»CV_DEL1∂CV_DIR»CV_MOD1+1CTIN1:∂GATERESC»GATEC‘óäPC_C»PC_CèCT0ÆPC_C+1CT0:∂FLRCΩFLRC+1éCT0C∂FLRC»PWMC∂FLRC+1»PWMC+1∂#255»CMOD+1CT0C:∂FILTCHANò#1çCT0A∂INITCUTΩINITCUT+1éCT0A∂INITCUT»CUTOFF∂INITCUT+1»CUTOFF+1CTMOD:∂#0»MUSIC+1CT0A:∂FLAGCéCT0B∂CGAT∑CEF_TIMEéCT0AA…CEF_WAIT∂CEF_FREQ»SID+14»OLDFS+4;REMOVE∂CEF_FREQ+1»SID+15»OLDFS+5;REMOVE∂CEF_GATECT0AA:Ω#1»SID+18CT0B:¥MUSICC_FOR:∂(PC_C),Y∞»REPC∂PC_Cóä#2»RESC»PC_C∂PC_C+1ä#0»RESC+1»PC_C+1¥CTOPC_NEXT:ûREPCéCT1A∂RESC»PC_C∂RESC+1»PC_C+1¥CTOPC_GATE:∂#1»FLAGC∂(PC_C),Y∞»GATERESCCT1A:¥ADDYCC_KILL:∂#0»FLAGC¥ADDYCC_SEND:∂(PC_C),YCTT4:–∞∂(PC_C),Y∞»SID,X∂(PC_C),Yò#255çCTT4∞¥ADDYCC_SETGATE:∂(PC_C),Y»SID+18»CGAT∞¥ADDYCC_STOP:ÆSTOPC¥MUSICC_PULSE:∂(PC_C),Y∞»RATEC∂(PC_C),Y∞»FLRC»PWMC∂(PC_C),Y∞»FLRC+1»PWMC+1¥ADDYCC_FREQS:ûFREQC¥CHCMAC_FILTER:∂(PC_C),Y»FILTRATE∞∂(PC_C),Y»CTMOD+1∞∂(PC_C),Y»CUTOFF»INITCUT∞∂(PC_C),Y»CUTOFF+1»INITCUT+1∞¥ADDYCC_CLAIM:∂#1»FILTCHAN¥ADDYCC_GOSUB:∂PC_Cóä#3»GOSC∂PC_C+1ä#0»GOSC+1∂(PC_C),Y–∞∂(PC_C),Y»PC_C+1…PC_C¥CTOPC_RETURN:∂GOSC»PC_C∂GOSC+1»PC_C+1¥CTOPC_TRANS:∂(PC_C),Y»TRANC∞¥ADDYCC_SETVIB:∂(PC_C),Y»CV_DEL∞∂(PC_C),Y»CV_RATE∞∂(PC_C),Y»CV_LIM+1∞∂(PC_C),Y»CV_DIR∞¥ADDYCC_EFFECT:∂(PC_C),Y»CEF_TIME∞∂(PC_C),Y»CEF_GATE∞∂(PC_C),Y»CEF_FREQ∞∂(PC_C),Y»CEF_FREQ+1∞¥ADDYCCEF_FREQ:¢0C_END:∂(PC_C),Y»ENDITC∞¥ADDYCJUMPC_LO:°<C_PULSE°<C_NEXT°<C_FOR°<C_GATE°<C_KILL°<C_SEND°<C_STOP°<C_FREQS°<C_FILTER°<C_CLAIM°<C_GOSUB°<C_RETURN°<C_TRANS°<C_SETGATE°<C_SETVIB°<C_EFFECT°<C_ENDJUMPC_HI:°>C_PULSE°>C_NEXT°>C_FOR°>C_GATE°>C_KILL°>C_SEND°>C_STOP°>C_FREQS°>C_FILTER°>C_CLAIM°>C_GOSUB°>C_RETURN°>C_TRANS°>C_SETGATE°>C_SETVIB°>C_EFFECT°>C_END;=====================================;DO FILTERING THINGSMUSIC:∂#0çMUS3MUS0:∂CUTOFFÀ«FILTRATE»CUTOFFêMUS1ûCUTOFF+1íMUS2MUS1:∂CUTOFF+1çCHANSTART∂CUTOFFò#50êCHANSTARTMUS2:ûMUSIC+1MUS3:∂CUTOFFóäFILTRATE»CUTOFFèMUS4ÆCUTOFF+1MUS4:∂CUTOFF+1ò#4èCHANSTART∂CUTOFFò#205èCHANSTARTÆMUSIC+1¥MUS0CHANSTART:∂CUTOFF»SID+21∂CUTOFFπAπAπA»TEMP∂CUTOFF+1πA≈A≈A≈AΩTEMP»SID+22√NOTES_LO:°12,28,45,62,81,102,123°145,169,195,221,250,24°56,90,125,163,204,246°35,83,134,187,244,48°112,180,251,71,152,237°71,167,12,119,233,97°225,104,247,143,48,218°143,78,24,239,210,195°195,209,239,31,96,181°30,156,49,223,165,135°134,162,223,62,193,107°60,57,99,190,75,15,12°69,191,125,131,214,121°115,199,124,151,30,24°139,126,250,6,172,243°230,143,248,46NOTES_HI:°1,1,1,1,1,1,1,1,1,1,1,1°2,2,2,2,2,2,2,3,3,3,3,3°4,4,4,4,5,5,5,6,6°7,7,7,8,8,9,9,10,11,11°12,13,14,14,15,16,17,18°19,21,22,23,25,26,28,29°31,33,35,37,39,42,44,47°50,53,56,59,63,67,71,75°79,84,89,94,100,106,112°119,126,134,142,150,159°168,179,189,200,212,225°238,253BOT:;=====================================;DATA FOR MUSIC THING         EXTRASGATE_CON:®$83;             <1>SEND:®$85;             <n>END:®$FF;FOR:®$82;             <1>NEXT:®$81;             <0>KILL:®$84;             <0>STOP:®$86;             <0>PULSE:®$80;             <3>FREQS:®$87;             <0>NOFREQS:®0FILTER:®$88;             <3>CLAIM:®$89;             <0>GOSUB:®$8A;             <2>GOTO:®$8A;             <2>RETURN:®$8B;             <0>TRANSPOSE:®$8C;             <1>GATE:®$8D;             <1>VIB:®$8E;             <4>EFFECT:®$8F;             <2>ENDIT:®$90;             <1>;.....................................TOPDATA:;=====================================TIM_A:°GATE_CON,8°TRANSPOSE,0°SEND°24,%00001111°05,$00°06,$66°12,$00°13,$66°19,$00°20,$66°END°EFFECT,0,32¢$FFFF°GATE,32°56,16,60,16,56,16°57,16,61,16,57,16°56,16,60,16,56,16°57,16,61,16,57,16°EFFECT,1,128¢$FFFF°SEND°5,$08°6,$08°12,$08°13,$08°19,$09°20,$097°END°GATE_CON,2°GATE,64°PULSE,50¢$3FF°GOSUB¢STAR1°TRANSPOSE,253°GOSUB¢STAR1°TRANSPOSE,3°GOSUB¢STAR1°FOR,4°GATE,64°25,12,25,12°GATE,128°120,24,120,24,120,24°120,24,120,24,120,24°120,24°NEXT°FOR,5°20,24,120,24,20,24,120,24°20,24,120,24,20,24°120,12,120,6,120,6°NEXT°PULSE,30¢$3FF°GATE,64°SEND°5,0°6,$FF°END°TRANSPOSE,254°23,6,21,6,20,36°FOR,11°20,48°NEXT°SEND°5,0°6,$FF°12,0°13,$9F°19,0°20,$5F°END°KILL°GATE,32°GOSUB¢SCALE°80,20°SEND°5,$07°6,$06°12,$34°13,$EE°19,$34°20,$EE°END°PULSE,120¢$400°GATE,64°TRANSPOSE,0°GATE_CON,2°EFFECT,2,128¢$FFFF°FOR,34°GOSUB¢FLOYD°NEXT°SEND°19,$07°20,$06°END°FOR,6°GOSUB¢FLOYD2°NEXT°GATE_CON,8°SEND°05,$00°06,$66°19,$00°20,$66°END°EFFECT,0,32¢$FFFF°GATE,32°56,16,60,16,56,16°SEND°5,$06°6,$07°19,$06°20,$07°END°EFFECT,2,128¢$FFFF°GATE,64°GATE_CON,1°FOR,4°GOSUB¢FLOYD2°NEXT°TRANSPOSE,249°FOR,83°GOSUB¢FLOYD°NEXT°PULSE,80¢$3AA°TRANSPOSE,0°GOSUB¢STAR1°TRANSPOSE,251°GOSUB¢STAR1°SEND°5,$1D°6,$0D°12,$1D°13,$0D°19,$1D°20,$0D°END°23,96,24,96°GOTO¢TIM_A;.....................................TIM_B:°GATE_CON,8°TRANSPOSE,0°GATE,32°60,16,63,16,60,16°61,16,64,16,61,16°60,16,63,16,60,16°61,16,64,16,61,16°GATE_CON,1°GATE,64°PULSE,70¢$3FF°GOSUB¢STAR2°TRANSPOSE,253°GOSUB¢STAR2°TRANSPOSE,3°GOSUB¢STAR2°25,12,25,12°SEND°12,$03°13,$D0°19,$00°20,$D0°END°GATE_CON,8°PULSE,32¢0°GATE,64°GOSUB¢SOLO°SEND°12,0°13,$99°19,0°20,$99°END°PULSE,80¢$3FF°GATE_CON,1°GOSUB¢PASS1°TRANSPOSE,1°GOSUB¢PASS1°TRANSPOSE,255°GOSUB¢PASS1°TRANSPOSE,254°GOSUB¢PASS1°GOSUB¢PASS1°SEND°24,%00101111°23,%11110110°12,$F0°13,$FF°19,$F0°20,$FF°END°GATE,129°FILTER,4,0¢0°GOSUB¢PINK°SEND°24,%00001111°23,0°12,$00°13,$C0°19,$00°20,$C0°END°GATE,16°GATE_CON,6°FOR,6°68,12,80,12,80,12,80,12°NEXT°GATE,33°KILL°56,10°GOSUB¢SCALE°80,10°TRANSPOSE,0°PULSE,65¢0°GATE,64°KILL°80,192,80,192°GATE,33°SEND°12,0°13,$A0°END°KILL,GATE_CON,150°GOSUB¢ARPE°GOSUB¢ARPE°GOSUB¢EPRA°TRANSPOSE,255°GOSUB¢EPRA°GOSUB¢EPRA°TRANSPOSE,0°GOSUB¢EPRA°TRANSPOSE,255°GOSUB¢EPRA°GOSUB¢EPRA°TRANSPOSE,254°GOSUB¢EPRA°GOSUB¢EPRA°GOSUB¢EPRA°GOSUB¢EPRA°GATE,0°TRANSPOSE,0°GATE_CON,1°FOR,7°1,192°NEXT°1,96+48°SEND°12,$03°13,$03°END°68,24°SEND°12,$DC°13,0°19,$DC°20,0°END°GATE,128°GATE_CON,250°120,192°GATE_CON,142°120,144°SEND°19,$7D°20,$20°12,$7D°13,$10°23,%00000110°24,%00011111°END°FILTER,0,0¢$200°GATE_CON,250°20,192,KILL°20,144°GATE,17°SEND°23,%00000100°END°KILL°GOSUB¢PHONE°GOSUB¢PHONE°GOSUB¢PHONE°FOR,2,76,2,72,2,NEXT°GATE,0,GATE_CON,22°SEND°12,0°13,$60°END°10,24,GATE_CON,255°GATE,33°GOSUB¢SIREN°GATE,16,KILL°FOR,8°FREQS¢65535°48¢NOFREQS°NEXT°GATE,64°GATE_CON,1°32,25°GATE_CON,190°PULSE,120¢$3AA°TRANSPOSE,12°FOR,8°GOSUB¢FLOYD°NEXT°SEND°12,$06°13,$06°19,$06°20,$06°END°GATE_CON,1°GATE,16°FOR,4°GOSUB¢BEATA°NEXT°FOR,4°GOSUB¢BEATB°NEXT°FOR,4°GOSUB¢BEATC°NEXT°GATE,64°TRANSPOSE,5°FOR,4°GOSUB¢FLOYD°NEXT°SEND°5,$09°6,$09°12,$09°13,$09°END°PULSE,80¢$3AA°TRANSPOSE,0°GOSUB¢STAR2°TRANSPOSE,251°GOSUB¢STAR2°35,96,36,96°GOTO¢TIM_B;.....................................TIM_C:°GATE_CON,8°TRANSPOSE,0°GATE,0°60,16*6,60,16*6°GATE_CON,1°GATE,128°FOR,6°GOSUB¢RYTH°NEXT°20,12,20,12°GATE,64°PULSE,32¢0°TRANSPOSE,10°GATE_CON,8°GOSUB¢SOLO°PULSE,80¢$3FF°TRANSPOSE,3°GATE_CON,1°GOSUB¢PASS2°TRANSPOSE,1°GOSUB¢PASS2°TRANSPOSE,255°GOSUB¢PASS2°TRANSPOSE,254°GOSUB¢PASS2°GOSUB¢PASS2°PULSE,10¢0°GATE,%01000001°GOSUB¢PINK°GATE,16°FOR,6°TRANSPOSE,5°80,12,92,12,92,12,92,12°NEXT°TRANSPOSE,254°GATE,33°KILL°56,20°GOSUB¢SCALE°TRANSPOSE,0°PULSE,128¢0°GATE,64°KILL°56,192,56,192°GATE_CON,1°SEND°19,$0A°20,$0A°END°TRANSPOSE,12°53,48,55,48,56,48,53,48°55,48,53,48,51,48,55,48°53,48,55,36,53,6,55,6°56,48,55,16,56,16,58,16°55,48,56,36,55,6,53,6°55,36,55,6,56,6,58,32°56,8,55,8°VIB,8,60,240,255°56,48,55,64,60,32°56,48,55,48,60,24,55,24°54,96,54,48,54,48°VIB,0,0,0,0°GATE,16°TRANSPOSE,45°FOR,4°GOSUB¢FLOYD2°NEXT°TRANSPOSE,47°PULSE,120¢$400°FOR,2°GOSUB¢FLOYD2°NEXT°GATE_CON,8°TRANSPOSE,0°60,16,63,16,60,16°TRANSPOSE,45°GATE_CON,1°FOR,4°GOSUB¢FLOYD2°NEXT°TRANSPOSE,5°GATE,64°FOR,4°GOSUB¢FLOYD°NEXT°GATE,128°FOR,4°GOSUB¢NOISE°NEXT°SEND°20,$FF°END°FOR,4°GOSUB¢NOISE°NEXT°SEND°20,$06°END°GATE,64°TRANSPOSE,12°FOR,4°GOSUB¢FLOYD°NEXT°TRANSPOSE,24°FOR,4°GOSUB¢FLOYD°NEXT°56,24°TRANSPOSE,0°GATE,128°GATE_CON,250°100,192°GATE_CON,142°100,144,GATE,129,KILL°50,192,50,144°50,150,50,150,50,158°SEND°23,%11110110°24,%00011111°20,$70°END°FILTER,0,0¢$1A0°GATE,33°GATE_CON,255°GOSUB¢SIREN°FREQS¢$2117°24¢NOFREQS°SEND°12,0°13,$FF°19,0°20,$F0°23,0°END°GATE_CON,4°GATE,17°FOR,15°FREQS¢65535°8¢NOFREQS°NEXT°SEND°19,$BC°20,$0C°18,16°END°GATE_CON,190°TRANSPOSE,41°FOR,33°30,1,32,1,44,1,32,1,35,1°30,1,29,1,27,1°NEXT°GATE_CON,1°32,25°SEND°12,$CD°13,$0D°19,$CD°20,$0D°END°GATE_CON,190°GATE,64°PULSE,120¢$3AA°TRANSPOSE,5°FOR,8°GOSUB¢FLOYD°NEXT°GATE_CON,1°GATE,128°FOR,4°GOSUB¢BEATA°NEXT°FOR,4°GOSUB¢BEATB°NEXT°FOR,4°GOSUB¢BEATC°NEXT°SEND°19,$08°20,$08°END°FOR,5°GOSUB¢RYTH°NEXT°GATE,64°49,96,50,96°GOTO¢TIM_C;.....................................;SUBROUTINESSTAR1:°FOR,2°25,12,25,12°47,6,25,6,25,6°47,6,25,6,25,6°47,6,25,6,46,12,23,12°25,12,25,12°47,6,25,6,25,6°47,6,25,6,25,6°47,6,25,6,42,12,23,12°NEXT,RETURNSTAR2:°FOR,2°37,12,37,12°52,6,37,6,37,6°52,6,37,6,37,6°52,6,37,6,54,12,35,12°37,12,37,12°52,6,37,6,37,6°52,6,37,6,37,6°52,6,37,6,46,12,35,12°NEXT,RETURNSOLO:°37,6,38,6,39,6,40,6,41,6°42,6,43,6,44,6,45,6,46,6°47,6,48,6°49,12,47,6,44,6,47,12°44,6,42,6,44,12,42,6,40,6°42,12,40,12,37,48°GATE_CON,18,48,2,49,22°GATE_CON,8°47,3,48,3,47,3°45,3,42,3,40,3,37,3,35,3°36,3,35,3,33,3,30,3,28,12°29,12,30,12,31,12,32,12°33,12,36,12°FOR,4°37,6,35,6,37,12,40,12°NEXT°44,12,42,12,40,12,35,12°FOR,4°49,12,47,6,44,6°NEXT°49,4,46,4,42,4°50,4,47,4,43,4°51,4,48,4,44,4°52,4,49,4,45,4°53,4,50,4,46,4°54,4,51,4,47,4°55,4,52,4,48,4°56,4,53,4,49,4°RETURNPASS1:°FOR,2°25,6,47,6,25,6,25,6°47,6,25,6,25,6,47,6°25,6,25,6,47,6,25,6°49,6,47,6,46,12°NEXT,RETURNPASS2:°FOR,2°37,6,44,6,37,6,37,6°44,6,37,6,37,6,44,6°37,6,37,6,44,6,37,6°46,6,44,6,42,12°NEXT,RETURNPINK:°FOR,24°68,2,72,2,75,2,77,2,74,2°70,2,NEXT,RETURNSCALE:°56,3,57,3,58,3,59,3,60,3°61,3,62,3,63,3,64,3,65,3°66,3,67,3,68,3,69,3,70,3°71,3,72,3,73,3,74,3,75,3°76,3,77,3,78,3,79,3,80,3°RETURNFLOYD:°30,6,32,6,44,6,32,6,35,6°30,6,29,6,27,6°RETURNFLOYD2:°30,3,32,3,44,6,32,6°30,6,35,6°30,6,29,6,27,6°RETURNARPE:°FOR,4°61,6,56,6,53,6,49,6°NEXT°FOR,4°65,6,61,6,56,6,53,6°NEXT°FOR,4°67,6,63,6,58,6,55,6°NEXT°FOR,4°63,6,58,6,55,6,51,6°NEXT,RETURNEPRA:°61,3,56,3,53,3,49,3°53,3,56,3,61,3,56,3°53,3,49,3,53,3,56,3°61,3,56,3,53,3,49,3°RETURNNOISE:°60,6,70,6,80,6,90,6,100°6,90,6,80,6,70,6°RETURNPHONE:°FOR,6,76,2,72,2,NEXT°GATE,1,60,6,GATE,17°FOR,6,76,2,72,2,NEXT°GATE,1,60,96,GATE,17°RETURNSIREN:°VIB,1,30,0,255°20°255°VIB,0,0,0,0°FREQS¢$2117°30¢NOFREQS°RETURNBEATA:°FREQS¢2000°6¢65533°6¢65533°6¢65533°6¢4000°6¢65533°6¢65533°6¢65533°6¢NOFREQS°RETURNBEATB:°FREQS¢2000°6¢65533°6¢65533°6¢65533°6¢4000°6¢4000°6¢4000°6¢4000°6¢NOFREQS°RETURNBEATC:°FREQS¢2000°6¢65533°6¢65533°6¢4000°6¢65533°6¢65533°6¢2000°6¢4000°6¢NOFREQS°RETURNRYTH:°20,24,120,24,20,24,120,24°20,24,120,24,20,24°120,12,120,6,120,6°RETURNBOTDATA:ˇˇTDATA