 HEXLD A,(V_RATE_B)LD DE,5054HCALL HEXLD A,(V_RATE_C)LD DE,505AHCALL HEXLD A,(V_LIM2_A)LD DE,506EHCALL HEXLD A,(V_LIM2_B)LD DE,5074HCALL HEXLD A,(V_LIM2_C)LD DE,507AHCALL HEXLD A,(V_DIR_A)LD DE,508EHCALL HEXLD A,(V_DIR_B)LD DE,5094HCALL HEXLD A,(V_DIR_C)LD DE,509AHCALL HEXLD A,(LENGTH_A)LD DE,50AEHCALL HEXLD A,(LENGTH_B)LD DE,50B4HCALL HEXLD A,(LENGTH_C)LD DE,50BAHCALL HEXLD A,(VOLUME_A)LD DE,50CEHCALL HEXLD A,(VOLUME_B)LD DE,50D4HCALL HEXLD A,(VOLUME_C)LD DE,50DAHCALL HEXRETMgetaddr:LD A,(McursorY)AND 18HOR 40HLD D,ALD A,(McursorY)RRCA RRCA RRCA AND 0E0HLD E,ALD A,(McursorX)ADD ELD E,ARETMat:LD A,(IX+0)LD (McursorX),AINC IXLD A,(IX+0)LD (McursorY),AINC IXRETPRattr:LD A,DRRARRARRAAND 3OR 58HLD D,ALD A,(Mcolour)LD (DE),ARET;======================================; AY MUSIC DRIVER V2 BY S.RUDDYCODE_TOP:PC_A:DW 0PC_B:DW 0PC_C:DW 0RETURN_A:DW 0RETURN_B:DW 0RETURN_C:DW 0FREQ_A:DW 0FREQ_B:DW 0FREQ_C:DW 0LOOP_A:DW 0LOOP_B:DW 0LOOP_C:DW 0STOP_A:DB 0STOP_B:DB 0STOP_C:DB 0ENDIT_A:DB 0ENDIT_B:DB 0ENDIT_C:DB 0TRANS_A:DB 0TRANS_B:DB 0TRANS_C:DB 0LENGTH_A:DB 0LENGTH_B:DB 0LENGTH_C:DB 0IGNORE_A:DB 0IGNORE_B:DB 0IGNORE_C:DB 0W_WAIT_A:DB 0W_WAIT_B:DB 0W_WAIT_C:DB 0W_DEL1_A:DB 0W_DEL1_B:DB 0W_DEL1_C:DB 0W_DEL2_A:DB 0W_DEL2_B:DB 0W_DEL2_C:DB 0PORT_A:DB 0PORT_B:DB 0PORT_C:DB 0V_DEL_A:DB 0V_DEL_B:DB 0V_DEL_C:DB 0E_TIME_A:DB 0E_TIME_B:DB 0E_TIME_C:DB 0REPEAT_A:DB 0REPEAT_B:DB 0REPEAT_C:DB 0DISTORT_A:DB 0DISTORT_B:DB 0DISTORT_C:DB 0COUNT_A:DB 0COUNT_B:DB 0COUNT_C:DB 0OLDFREQ_A:DB 0OLDFREQ_B:DB 0OLDFREQ_C:DB 0A_CONT_A:DB 0A_CONT_B:DB 0A_CONT_C:DB 0VOLUME_A:DB 0VOLUME_B:DB 0VOLUME_C:DB 0FLIP1_A:DB 0FLIP1_B:DB 0FLIP1_C:DB 0OLDNOTE_A:DB 0OLDNOTE_B:DB 0OLDNOTE_C:DB 0A_INIT_A:DB 0A_INIT_B:DB 0A_INIT_C:DB 0A_ATT_A:DB 0A_DEC_A:DB 0A_ATT_B:DB 0A_DEC_B:DB 0A_ATT_C:DB 0A_DEC_C:DB 0A_SUS_A:DB 0A_SUS_B:DB 0A_SUS_C:DB 0A_CYC_A:DB 0A_CYC_B:DB 0A_CYC_C:DB 0A_STAGE_A:DB 0A_STAGE_B:DB 0A_STAGE_C:DB 0A_TIME_A:DB 0A_TIME_B:DB 0A_TIME_C:DB 0W_OFF_A:DB 0W_OFF_B:DB 0W_OFF_C:DB 0TARGET_A:DB 0TARGET_B:DB 0TARGET_C:DB 0V_DEL1_A:DB 0V_DEL1_B:DB 0V_DEL1_C:DB 0V_RATE_A:DB 0V_RATE_B:DB 0V_RATE_C:DB 0V_LIM1_A:DB 0V_LIM1_B:DB 0V_LIM1_C:DB 0V_LIM2_A:DB 0V_LIM2_B:DB 0V_LIM2_C:DB 0V_DIR_A:DB 0V_DIR_B:DB 0V_DIR_C:DB 0E_FREQ_A:DW 0E_FREQ_B:DW 0E_FREQ_C:DW 0E_WAIT_A:DB 0E_WAIT_B:DB 0E_WAIT_C:DB 0E_BITS_A:DB 0E_BITS_B:DB 0E_BITS_C:DB 0MEMGATE_A:DB 0MEMGATE_B:DB 0MEMGATE_C:DB 0GATE_A:DB 0GATE_B:DB 0GATE_C:DB 0GATERES_A:DB 0GATERES_B:DB 0GATERES_C:DB 0FLESH_A:DB 0FLESH_B:DB 0FLESH_C:DB 0;--------------------------------------; tune initialisation enter with; a = tune number.TUNE:ADD ALD C,ALD B,0LD HL,TUNES_AADD HL,BCLD E,(HL)INC HLLD D,(HL)LD (PC_A),DELD HL,TUNES_BADD HL,BCLD E,(HL)INC HLLD D,(HL)LD (PC_B),DELD HL,TUNES_CADD HL,BCLD E,(HL)INC HLLD D,(HL)LD (PC_C),DELD HL,0FFFFHLD (STOP_A),HLLD (STOP_A+2),HLLD (STOP_A+4),HLTUNE_IN:LD (OLDFREQ_A),ALD (OLDFREQ_B),ALD (OLDFREQ_C),ALD HL,TRANS_ALD DE,TRANS_A+1LD BC,36LD (HL),0LDIR LD A,1LD (COUNT_A),ALD (COUNT_B),ALD (COUNT_C),ALD A,00001001BLD (FLESH_A),ASLA ALD (FLESH_B),ASLA ALD (FLESH_A),ALD HL,STACK_ALD (SP_A),HLLD HL,STACK_BLD (SP_B),HLLD HL,STACK_CLD (SP_C),HLJP OUT_FLESH;--------------------------------------; call before initialising sound fxTUNEOFF:LD C,0LD A,8CALL OUT_CA_AYLD C,0LD A,9CALL OUT_CA_AYLD C,0LD A,10CALL OUT_CA_AYXOR ALD (STOP_A),ALD (STOP_B),ALD (STOP_C),ADEC AJP TUNE_IN;--------------------------------------; do fx. enter with a = fx numberFX:ADD ALD HL,FX_TABCALL ADDHLALD A,(HL)INC HLLD H,(HL)LD L,AFLOOP:EX DE,HLLD A,(DE)OR ARET M; RRASRL ALD HL,STOP_ACALL ADDHLALD (HL),255LD HL,COUNT_ALD A,(DE)SRL ACALL ADDHLALD (HL),1LD A,(DE)LD HL,PC_ACALL ADDHLAINC DEEX DE,HLLDILDIJR FLOOPADDHLA:ADD LLD L,ARET NCINC HRET;-----------;--------------------------------------NOT_A_bug:LD C,DLD B,8PRloop:LD A,(HL)LD (DE),AINC HLINC DDJNZ PRloopLD D,CRETAT:EQU 22INK:EQU 16CLS:EQU 15DO_MESAGE:POP IXCALL DO_STRINGJP (IX)DO_STRING:LD A,(IX+0)INC IXOR ARET MCP 32JR C,McontrolCALL MgetcharCALL MgetaddrCALL NOT_A_bugCALL PRattrCALL INCcursorJR MESSMcontrol:LD HL,DO_STRINGPUSH HLCP 15JR Z,MclsCP 22JP Z,MatCP 16JR Z,MinkRETMcolour:DB 0McursorX:DB 0McursorY:DB 0Mink:LD A,(IX+0)INC IXLD (Mcolour),ARETMcls:LD HL,4000HLD (HL),LLD DE,4001HLD BC,1AFFHLDIR LD (McursorX),BCRETINCcursor:LD HL,McursorXLD A,(HL)INC AAND 31LD (HL),ARET NZINC HLINC (HL)RETMgetchar:LD L,ALD H,0ADD HL,HLADD HL,HLADD HL,HLLD BC,3C00HADD HL,BCRETD 31ontrolCALL MgetcharCALL MgetaddrCALL NOT_A_bugCALL PRattrCALL INCcursorJR MESSMcontrol:LD HL,DO_STRINGPUSH HLCP 15JR Z,MclsCP 22JP Z,MatCP 16JR Z,MinkRETMcolour:DB 0McursorX:DB 0McursorY:DB 0Mink:LD A,(IX+0)INC IXLD (Mcolour),ARETB 0A_DEC_A:DB 0A_ATT_B:DB 0A_DEC_B:DB 0A_ATT_C:DB 0A_DEC_C:DB 0A_SUS_A:DB 0A_SUS_B:DB 0A_SUS_C:DB 0A_CYC_A:DB 0A_CYC_B:DB 0A_CYC_C:DB 0A_STAGE_A:DB 0A_STAGE_B:DB 0A_STAGE_C:DB 0A_TIME_A:DB 0A_TIME_B:DB 0A_TIME_C:DB 0W_OFF_A:DB 0W_OFF_B:DB 0W_OFF_C:DB 0TARGET_A:DB 0TARGET_B:DB 0TARGET_C:DB 0V_DEL1_A:DB 0V_DEL1_B:DB 0V_DEL1_C:DB 0V_RATE_A:DB 0V_RATE_B:DB 0V_RATE_C:DB 0V_LIM1_A:DB 0V_LIM1_B:DB 0V_LIM1_C:DB 0V_LIM2_A:DB 0V_LIM2_B:DB 0V_LIM2_C:DB 0V_DIR_A:DB 0V_DIR_B:DB 0V_DIR_C:DB 0E_FREQ_A:DW 0E_FREQ_B:DW 0E_FREQ_C:DW 0E_WAIT_A:DB 0E_WAIT_B:DB 0E_WAIT_C:DB 0E_BITS_A:DB 0E_BITS_B:DB 0E_BITS_C:DB 0REGISTER:DB 0REGISTER2:DB 0;--------------------------------------; tune initialisation enter with; a = tune number.TUNE:ADD ALD C,ALD B,0LD HL,TUNES_AADD HL,BCLD E,(HL)INC HLLD D,(HL)LD (PC_A),DELD HL,TUNES_BADD HL,BCLD E,(HL)INC HLLD D,(HL)LD (PC_B),DELD HL,TUNES_CADD HL,BCLD E,(HL)INC HLLD D,(HL)LD (PC_C),DELD A,0FFHLD (ORG 50000LOAD 0C000HTUNES:EQU 5EFFECTS:EQU 2;--------------------------------------DW CALCDB TUNESDB EFFECTS;--------------------------------------DATA_TOP:TUNES_A:DW TITLE_ADW SILENTDW SILENTDW HIGH_ADW INTRO_ADW 5DW 6DW 7DW 8DW 9TUNES_B:DW TITLE_BDW GAME1_BDW GAME2_BDW HIGH_BDW INTRO_BDW 5DW 6DW 7DW 8DW 9TUNES_C:DW TITLE_CDW GAME1_CDW GAME2_CDW HIGH_CDW INTRO_CDW 5DW 6DW 7DW 8DW 9FX_TAB:DW FIREDW KILL;--------------------------------------FOR:EQU 080HNEXT:EQU 081HLENGTH:EQU 082HSTOP:EQU 083HGOSUB:EQU 084HRETURN:EQU 085HTRANS:EQU 086HDISTORT:EQU 087HSEND:EQU 088HADSR:EQU 089HENVON:EQU 08AHWOBBLE:EQU 08BHPORT:EQU 08CHVIB:EQU 08DHIGNORE:EQU 08EHEFFECT:EQU 08FHGOTO:EQU 090H;======================================; SOUND FX DATAFIRE:DB 0DW SHOOTDB $FFKILL:DB 0DW BASHDB $FFSHOOT:DB GATE_CON,255,ENDIT,255DB VIB,0,0,0,0,GATE,32DB SEND,5,$00,6,$F0DB 24,%00011111,ENDDB LENGTH,0,FOR,3DB PORT,0,70,1,PORT,2DB 10,8,NEXT,GATE,128DB PORT,0,80,1,PORT,18DB 20,5DB GATE,0,STOPBASH:DB GATE_CON,255,ENDIT,255DB VIB,0,0,0,0,GATE,64DB PULSE,0DW $700DB LENGTH,0DB SEND,5,$00,6,$F0DB 24,%00011111,ENDDB PORT,0,20,4,32,4,44,4DB 56,4,44,4,32,4,20,4DB GATE,0,STOPSILENT:DB STOP;=====================================TITLE_A:DB GATE_CON,255,ENDIT,1DB SENDDB 5,$0FDB 6,$0FDB 12,$0FDB 13,$0FDB 19,$04DB 20,$0FDB 23,%11110011DB 24,%00101111DB END,GATE,64DB CLAIM,FILTER,0,0DW $25A,0,0DB WOBBLE,255,1,255DB VIB,36,160,0,0DB PULSE,60DW $400DB GOSUBDW INTRODB FOR,12,GOSUBDW RIFFDB NEXT,PORT,0DB GOSUBDW RIFF2DB GATE,64,FILTER,0,0DW $25A,0,0DB GOSUBDW RIFF3DB FILTER,50,0DW $300,0,50DB GOSUBDW RIFF2DB FILTER,0,0DW $25A,0,0DB GATE,64,GOSUBDW RIFF4DB FILTER,50,0DW $300,0,50DB TRANS,249,FOR,4DB GOSUBDW RIFF1DB NEXTDB TRANS,0,FOR,4DB GOSUBDW RIFF1DB NEXTDB GATE,0,50,96,GATE,16DB VIB,1,250,0,